=====
GWBS ANLYSIS OF SCLERODERMA FEMALES (Marie Hudson SCLERODERMA DATA & Kaiqiong Zhao SOMNiBUS & Tianyuan Lu ~PUBLICATION)
JEFFREY C.Y. YU (GREENWOOD LAB)
Jan 2021 - Oct 2022
=====

Information:
  Kathleen Klien: "datMETH"" in is a list of two corresponding to seperate files for 22+xy chromosomes; covariate file for all 20 m/f ssc/myo/control cases (note: MYO disease status and males sex needs to be taken out)
  Kaiqiong Zhao: SOMNiBUS vignette from her github
    -Analyzing whole genome DNA methylation profiles for the dorsal and ventral dentate gyrus of the hippocampus in mouse, raised in either standard or enriched environment
  Tianyuan Lu: annotation and resultant gene list from the same dataset using bumphunter package for DMR detection 

Navigate:
"/scratch/greenwood/jeffrey.yu/Marie_Hudson_Scleroderma_WGBS"
  Files included not generated by me in this directory:
    ~/Data (covariate data file from Kathleen, duplicated from kathleens directory)
    ~/Functions (updated version of SomniBus sent by email from Kaiqiong)

Subject:
  GWBS study using SOMNiBUS to detect DMRs of 9 scleroderma females vs. 4 control females (males and MYO patients excluded) with an adjustment for the continuous variable of age. Annotation and pathway analysis of resultant regions on both gene body, regions where methylation would induce silencing (promoters, first exon, CpG islands), and other infered regulatory regions. Comparison to bumphunter using Lu et al.


-----

Step 1. Partition Regions by Spacing
  1.1: Run '/Partitioning_Regions_Spacing/PT1:Spacing_Analysis:GENOME
      Output:
        -FORM: a seperate RData files for each chromosome analyzed
        -sequenced CpG sites partitioned into a set of CpG regions by genomic position
        -filtered set of CpG regions that are eligible for analysis using SOMNiBUS
        -SOMNiBUS analysis results one ligible CpG regions
        -runtimes for SOMNiBUS by chromosome
  1.2: Run '/Partitioning_Regions_Spacing/PT2:Constructing_Spacing_Info:GENOME
      Output:
        -FORM: a seperate RData file for each chromosome analyzed
        -generated statistics of interest for each CpG region, stratified by chromosome
        -runtimes for SOMNiBUS by chromosome
  1.3: Run '/Partitioning_Regions_Spacing/PT3:Constructing_Spacing_DataFrame:GENOME'
      Output:
        -FORM: a single RData files for the entire genome
        -generated statistics of interest for each CpG region for the entire genome
        -runtimes for SOMNiBUS by chromosome and for the whole genome



Step 2. Annotation
  2.1: Run '/Annotation/PT1:Annotation.R'
      Output:
        -Annotated regions and thier associated DMRs, each row corresponds to a single gene region, so multiple rows can use the same DMR (which most will)
  2.2: Run '/Annotation/PT2:Tabulate.R'
     Output:
      -dataframe of all DMR annotations and text files to input into QIAGEN IPA (SSC_Xbp_Summary:GENOME.txt)


Step 3. Pathway Analysis
  3.1: Upload '/Annotation/PT2_Results/' .txt files into IPA 
  3.2: Run core analysis for all with gene symbol as ID and p-values as expr.pval
    Output: Complete pathway analysis
  3.3: Go to pathways section of analysis and export as .txt file
  3.4: Place said file in '/Annotation/IPA_Results'
  3.4: Modify '/Report/FINAL:MH_SSC_Report:Genome.Rmd' final sections load() network files (.txt) to the filesnames in '/Annotation/IPA_Results'
  3.5 (optional) Repeat if needed for seperate analysis of somatic or sex chromosomes, or for primary/secondary analysis if multiple significance thresholds are used


REPORT (optional)
  -all other scripts are used to generate figures.



Manuscript
  -All Manuscript figures will be located in /Manuscript/Plots and are generated with /Manuscipt/QQ_Plot.R and /Manuscipt/Manhattan_Plot.R scripts
  -List of unique genes found in each analysis is located in /Manuscipt/Genes_List and are generated with the /Manuscipt/Genes_by_Significance.R
  -All Beta(t) plots for estimated disease effect on methylation is located in /Beta_of_Genes/Plots and are generated with the /Beta_of_Genes/Beta_Plots.R script
  -All runtimes for SOMNiBus are in /Manuscript/Plots and are generated with /Manuscipt/Runtimes.R
  -All comparisons to bumphunter and all bumphunter comparison associated plots are also located in manuscripts in the Bumphunter folder.
